
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Chapter 14 - Non-Linear Models &#8212; Pomona Psych 158 Online Textbook</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Pomona Psych 158 Online Textbook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Pomona College Psych 158 Online Textbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Unit 1 Describing Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://colab.research.google.com/github/smburns47/Psyc158/blob/main/chapter-1.ipynb">
   https://colab.research.google.com/github/smburns47/Psyc158/blob/main/chapter-1.ipynb
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter-2.html">
   Chapter 2 - Statistical Reasoning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter-3.html">
   Chapter 3 - What are Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter-4.html">
   Chapter 4 - Organizing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter-5.html">
   Chapter 5 - Describing Data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Unit 2 - Modeling Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter-6.html">
   Chapter 6 - Variation in Multiple Variables
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Unit 3 - Evaluating Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter-7.html">
   Chapter 7 - Principles of Data Visualization
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/smburns47/Psyc158/main?urlpath=tree/chapter-14.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/smburns47/Psyc158"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/smburns47/Psyc158/issues/new?title=Issue%20on%20page%20%2Fchapter-14.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/chapter-14.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nonlinear-relationships">
   14.1 Nonlinear relationships
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variable-transformations">
   14.2 Variable transformations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specifying-and-interpreting-nonlinear-models">
   14.3 Specifying and interpreting nonlinear models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#when-to-use-nonlinear-models">
   14.4 When to use nonlinear models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-parametric-models">
   14.5 Non-parametric models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#predictor-interactions">
   14.6 Predictor interactions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#choosing-the-best-model">
   14.7 Choosing the best model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-summary">
   Chapter summary
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Chapter 14 - Non-Linear Models</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nonlinear-relationships">
   14.1 Nonlinear relationships
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variable-transformations">
   14.2 Variable transformations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specifying-and-interpreting-nonlinear-models">
   14.3 Specifying and interpreting nonlinear models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#when-to-use-nonlinear-models">
   14.4 When to use nonlinear models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-parametric-models">
   14.5 Non-parametric models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#predictor-interactions">
   14.6 Predictor interactions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#choosing-the-best-model">
   14.7 Choosing the best model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-summary">
   Chapter summary
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run this first so it&#39;s ready by the time you need it</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;supernova&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;ggformula&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">supernova</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggformula</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="chapter-14-non-linear-models">
<h1>Chapter 14 - Non-Linear Models<a class="headerlink" href="#chapter-14-non-linear-models" title="Permalink to this headline">#</a></h1>
<p>In all the modeling we’ve done so far, we’ve relied on the general <em>linear</em> model to combine the effects of predictors in order to make a guess about the value of an outcome. This <em>linear</em> keyword means we have combined them with addition in the model equation. It implies that we think each predictor can contribute to explaining variance <em>regardless</em> of the value of any other predictor.</p>
<p>However, this isn’t always how the data generation process actually works. Not everything in the world is combined linearly. Gravity, a very simple deterministic model, has mass and distance integrated in multiplicative ways. If we think a data generation process in psychology is not linear, is that a fatal flaw in using the general linear model framework?</p>
<p>It turns out that the answer is no! The general linear model always combines things linearly. But we can use some tricks of math to turn nonlinear relationships into linear ones. In this chapter we’ll learn how to do this.</p>
<section id="nonlinear-relationships">
<h2>14.1 Nonlinear relationships<a class="headerlink" href="#nonlinear-relationships" title="Permalink to this headline">#</a></h2>
<p>First let’s conceptualize what it means for a data generation process to be nonlinear. We’ll think of this in the context of number of hours of study predicting someone’s grade on a test.</p>
<p>In this case, the separate components of the model are easy to identify - number of hours of study is the sole explanatory variable, and test grade is the outcome variable. If we were to fit a regression model on this data, we’d interpret the studying coefficient to mean the expected change in grade for every additional hour of study. In other words, we’d expect <em>every</em> additional hour of studying to result in the <em>same</em> change in grade. The difference in grade between 2 and 3 hours of study should be the same as between 12 and 13 hours of study. This sort of relationship would look like the plot below.</p>
<img src="images/ch14-linear.png" width=250>
<p>However, this sort of relationship doesn’t necessarily make sense. Due to our experience with studying, we know there are diminishing returns involved - studying a bit helps a lot more than not studying at all, but the different between a lot of studying and an extreme amount of studying probably doesn’t help our grade that much more. This sort of situation would look like the plot below instead.</p>
<img src="images/ch14-nonlinear.png" width=250>
<p>That curve in the graph is an example of a nonlinear relationship. It’s where the effect of an explanatory variable <em>depends on the value</em> of the explanatory variable.</p>
</section>
<section id="variable-transformations">
<h2>14.2 Variable transformations<a class="headerlink" href="#variable-transformations" title="Permalink to this headline">#</a></h2>
<p>We can incorporate this sort of relationship into our models by looking to how algebra handles this. Consider the basic equation for a straight line, <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">x</span></code>. This means for every one point increase in x, there is a one point increase in y, like in the graph below.</p>
<img src="images/ch14-graphstraight.png" width="500">
<p>Now consider the <em>polynomial</em> equation, <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">x^2</span></code>. This means that for every one point increase in x, you <em>square</em> the value of y. That kind of relationship creates a graph like the one below.</p>
<img src="images/ch14-graphcurved.png" width="500">
<p>In other words, the increase in Y between each level of x gets larger as x gets larger. The difference in Y between X=0 and X=1 is not very big, but the difference in Y between X=3 and X=4 is much bigger. By transforming the value of X into one that is squared, we can model this kind of increasingly stronger relationship.</p>
<p>In our data, then, if we have reason to believe that the <em>change</em> in predicted Y should get larger as X gets larger, we can use a polynomial form of the predictor X to model it. Note that this is not the same thing as saying that Y itself gets larger as X gets larger - that is true in a simple linear regression. This is saying that the <em>magnitude</em> of how much Y increases gets larger as X gets larger. By squaring the raw values of X to make a new variable X-squared, we can put that back into the context of the linear model, where the coefficient now means for every one-unit increase in <em>X-squared</em>, there is an expected increase in Y.</p>
<p>Let’s see how this plays out in some simulated data where we know what the true relationship is. First, we’ll randomly draw some predictor values from the normal distribution, and also add some normally-distributed measurement error to the mix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
<span class="n">predictor</span> <span class="o">&lt;-</span> <span class="nf">abs</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="n">error</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we’ll create an outcome variable that is a product of the predictor and measurement error. Specifically, it is a product of the <em>square</em> of the predictor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">outcome</span> <span class="o">&lt;-</span> <span class="m">2</span><span class="o">*</span><span class="n">predictor</span><span class="o">^</span><span class="m">2</span> <span class="o">+</span> <span class="n">error</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s see what would happen if we tried to model these with a simple linear model, <code class="docutils literal notranslate"><span class="pre">outcome</span> <span class="pre">~</span> <span class="pre">predictor</span></code>. Below is some code creating a dataframe, model, and a scatter plot with these values. Add a line with <code class="docutils literal notranslate"><span class="pre">supernova()</span></code> to measure how well we do with this model in predicting the outcome variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span>
<span class="n">linear_model</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">outcome</span> <span class="o">~</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span>
<span class="nf">gf_point</span><span class="p">(</span><span class="n">outcome</span> <span class="o">~</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">gf_lm</span><span class="p">()</span>

<span class="c1">#Use supernova() to tell us how good this model is</span>
</pre></div>
</div>
</div>
</div>
<p>That’s really good actually! A PRE of 0.89 is better than we almost ever get with real data. But in this case we know the data generation process - we know we can do better. In this case, the model is systematically underpredicting for both large and small values of X and overpredicting for middle values, because it’s trying to fit the best <em>straight</em> line. Compare the the graph from above to one where we draw the best-fitting curved line, using <code class="docutils literal notranslate"><span class="pre">gf_smooth()</span></code> from <code class="docutils literal notranslate"><span class="pre">ggformula</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">gf_point</span><span class="p">(</span><span class="n">outcome</span> <span class="o">~</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">gf_smooth</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This implies that the best relationship between <code class="docutils literal notranslate"><span class="pre">predictor</span></code> and <code class="docutils literal notranslate"><span class="pre">outcome</span></code> is not linear, but exponential - the slope of the line is getting steepr as <code class="docutils literal notranslate"><span class="pre">predictor</span></code> gets larger. Which is true, that’s how we computed <code class="docutils literal notranslate"><span class="pre">outcome</span></code> in our simulation! So, in order to force this relationship back to being linear and able to be modeled, let’s compute a squared version of predictor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Square the values of predictor to make a new variable, predictor_squared</span>
<span class="n">sim_data</span><span class="o">$</span><span class="n">predictor_squared</span> <span class="o">&lt;-</span> <span class="c1">#YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
<p>Now model that relationship, plot it, and investigate the model performance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">squared_model</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">outcome</span> <span class="o">~</span> <span class="n">predictor_squared</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span>
<span class="nf">gf_point</span><span class="p">(</span><span class="n">outcome</span> <span class="o">~</span> <span class="n">predictor_squared</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">gf_lm</span><span class="p">()</span>
<span class="nf">supernova</span><span class="p">(</span><span class="n">squared_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>That is an even better PRE score. We improved our prediction accuracy because our model structure is closer to what the true data generation process is.</p>
<p>That’s what data might look like under an exponential relationship. Now let’s look at how we might model the case described above, where there are diminishing increases in Y as X gets larger:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_data</span><span class="o">$</span><span class="n">outcome2</span> <span class="o">&lt;-</span> <span class="m">85</span> <span class="o">+</span> <span class="m">4</span><span class="o">*</span><span class="nf">log</span><span class="p">(</span><span class="n">sim_data</span><span class="o">$</span><span class="n">predictor</span><span class="p">)</span> <span class="o">+</span> <span class="n">error</span>
</pre></div>
</div>
</div>
</div>
<p>Now, <code class="docutils literal notranslate"><span class="pre">outcome</span></code> is a product of the <em>log</em> of <code class="docutils literal notranslate"><span class="pre">predictor</span></code> instead. If we model that and plot it assuming a linear relationship:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">linear2_model</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">outcome2</span> <span class="o">~</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span>
<span class="nf">gf_point</span><span class="p">(</span><span class="n">outcome2</span> <span class="o">~</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">gf_lm</span><span class="p">()</span>
<span class="nf">supernova</span><span class="p">(</span><span class="n">linear2_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Our PRE score is good, but not as good as it can be. We’re making especially bad predictions for small values of X (large residuals), and it looks like there should be a curved line where changes in predicted Y are smaller, the bigger X gets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">gf_point</span><span class="p">(</span><span class="n">outcome2</span> <span class="o">~</span> <span class="n">predictor</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">gf_smooth</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>So, let’s transform <code class="docutils literal notranslate"><span class="pre">predictor</span></code> using the <code class="docutils literal notranslate"><span class="pre">log()</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Take the log of predictor to make a new variable, predictor_log</span>
<span class="n">sim_data</span><span class="o">$</span><span class="n">predictor_log</span> <span class="o">&lt;-</span> <span class="c1">#YOUR CODE HERE</span>

<span class="n">log_model</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">outcome2</span> <span class="o">~</span> <span class="n">predictor_log</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span>
<span class="nf">gf_point</span><span class="p">(</span><span class="n">outcome2</span> <span class="o">~</span> <span class="n">predictor_log</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">gf_lm</span><span class="p">()</span>
<span class="nf">supernova</span><span class="p">(</span><span class="n">squared_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Again, we’ve gotten a much better PRE score this way because we’ve modeled the data generation process more accurately.</p>
</section>
<section id="specifying-and-interpreting-nonlinear-models">
<h2>14.3 Specifying and interpreting nonlinear models<a class="headerlink" href="#specifying-and-interpreting-nonlinear-models" title="Permalink to this headline">#</a></h2>
<p>When specifying the equation form of these nonlinear models, we want to write them in such a way that we see what data transformations were done. So, if we were to write the equation for study time and test grades being related via a log transform, we would write it as such:</p>
<div class="math notranslate nohighlight">
\[Y_i = b_0 + b_1log(X_i) + e_i\]</div>
<p>This makes it clear that we are making predictions about test grades not using the raw values of study time, but the log transform of study time. In the DATA = MODEL + ERROR framework, the MODEL portion of the equation would be b<sub>1</sub>log(X<sub>i</sub>).</p>
<p>When fitting this model with <code class="docutils literal notranslate"><span class="pre">lm()</span></code>, we can do one of two things. First, we can create a new variable like we just did previously, saving the transformed values to a new column in a data frame. Then we would use this new variable in the formula for a simple regression:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_data</span><span class="o">$</span><span class="n">predictor_log</span> <span class="o">&lt;-</span> <span class="nf">log</span><span class="p">(</span><span class="n">sim_data</span><span class="o">$</span><span class="n">predictor</span><span class="p">)</span>
<span class="nf">lm</span><span class="p">(</span><span class="n">outcome2</span> <span class="o">~</span> <span class="n">predictor_log</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This has the advantage of keeping the transformed values around for you to inspect. Alternatively, you can do the transformation directly in the formula of the model call:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">lm</span><span class="p">(</span><span class="n">outcome2</span> <span class="o">~</span> <span class="nf">log</span><span class="p">(</span><span class="n">predictor</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Interpreting the coefficients in these models can be tricky, however. It’s important to keep in mind that this coefficient refers to the <em>transformed</em> version of the predictor, and not the raw version. The more transformation we do to a variable, the farther away we get from the original units and the less sense it makes for the real world.</p>
<p>In the example above, we found that b<sub>1</sub> = 3.925. In natural language, this would mean for every one-unit increase in the <em>log</em> of <code class="docutils literal notranslate"><span class="pre">predictor</span></code>, we’d expect a change in <code class="docutils literal notranslate"><span class="pre">outcome</span></code> of 3.925. This is the only way to talk about a consistent effect of <code class="docutils literal notranslate"><span class="pre">predictor</span></code> on <code class="docutils literal notranslate"><span class="pre">outcome</span></code> regardless of its specific value, so this is the way you should report it when writing about model results. But it’s hard to conceptualize what that means, because we don’t think in terms of logs.</p>
<p>For your own understanding of the consequences of the model, it can be helpful to solve the equation for a few different values of <code class="docutils literal notranslate"><span class="pre">predictor</span></code> that you might care about and see what the predicted Y is. E.g., what’s the predicted test grade for someone who studies for 6 minutes, 1 hour, or 3 hours?</p>
<div class="math notranslate nohighlight">
\[\hat{Y} = 84.915 + 3.925*log(0.1) = 75.877\]</div>
<div class="math notranslate nohighlight">
\[\hat{Y} = 84.915 + 3.925*log(1) = 84.915\]</div>
<div class="math notranslate nohighlight">
\[\hat{Y} = 84.915 + 3.925*log(2) = 89.227\]</div>
<p>So in the case of a nonlinear model, you should write your interpretations of coefficients in terms of the transformed variable (“a predicted change in test grade of 3.925 points for every one-unit increase in log of study time”), but solve this equation a couple times to know for yourself what that really means.</p>
<p>Note that you have to be careful about interpreting the intercept as well. This is the expected outcome value when the <em>log</em> of the predictor variable is 0, NOT when the raw score of the predictor variable is 0. I.e., it is when the transformed variable equals 0. For a log to be equal to 0, the raw score actually needs to equal 1 (as in the second equation above). What is the log of a raw score of 0?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">log</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Oops, looks like we can’t even calculate that! Transformed variables can do weird things for extreme raw values, making predictions unstable.</p>
<p>To make things even more complicated, technically it’s possible to include transformed variables in multivariable models. You can fit as many parameters as you want, with any transformation of those variables as you want - R will do what you tell it to do so long as you use the correct syntax.</p>
<p>But again, making models more complex has tradeoffs. It might help you get to a better prediction <em>within a specific sample</em>, but could result in overfitting such that your model performs very poorly on new samples of data.</p>
</section>
<section id="when-to-use-nonlinear-models">
<h2>14.4 When to use nonlinear models<a class="headerlink" href="#when-to-use-nonlinear-models" title="Permalink to this headline">#</a></h2>
<p>Model specifications that you use in research should come primarily from existing theories or hypotheses about the data generation process. Thus, you should use nonlinear models when you suspect that variables are related to eachother in a nonlinear way.</p>
<p>However, it is actually rare to encounter nonlinear models in psychology. We usually don’t understand the data generation process well enough to expect anything more specific than “as X goes up, Y goes up too.” Additionally, there is often so much error in our measurements that it’s hard to see whether a linear or nonlinear line would fit the data better. Because of this, most people default to using linear models. Yet, there can be clues that point you towards using nonlinear alternatives.</p>
<p>Remember back in chapter 10 how we briefly talked about the shape of the error distribution? If the error distribution is roughly normal, our model is in general unbiased. It may be making errors when predicting outcome values for certain data points, even large errors. But if there isn’t any systematic pattern in those errors, then the model is likely to make unbiased estimates averaged across many predictions.</p>
<p>If the error distribution is skewed, however, our model is going to have problems. This means our model is biased - more often it makes a prediction that is too high or too low. Let’s see what the error distribution looks like for the case where we build a simple linear model when the true data generation process is an exponential relationship:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_data</span><span class="o">$</span><span class="n">linear_resid</span> <span class="o">&lt;-</span> <span class="nf">resid</span><span class="p">(</span><span class="n">linear_model</span><span class="p">)</span>
<span class="nf">gf_histogram</span><span class="p">(</span> <span class="o">~</span> <span class="n">linear_resid</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This definitely looks skewed, and suggests the model is usually making predictions that are too high (more residuals in the negative body of the distribution to balance out the extreme residuals in the positive tail).</p>
<p>Another way of investigating this is to make a scatter plot of the residuals, against what the predicted values are. If we’re modeling the data generation process in an unbiased way, this scatterplot should look like a random cloud of data points. There shouldn’t be any relationship between the value of what the model predicts, and how far off that prediction is from the actual values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_data</span><span class="o">$</span><span class="n">squared_predicted</span> <span class="o">&lt;-</span> <span class="nf">predict</span><span class="p">(</span><span class="n">squared_model</span><span class="p">)</span>
<span class="n">sim_data</span><span class="o">$</span><span class="n">squared_resid</span> <span class="o">&lt;-</span> <span class="nf">resid</span><span class="p">(</span><span class="n">squared_model</span><span class="p">)</span>
<span class="nf">gf_point</span><span class="p">(</span><span class="n">squared_resid</span> <span class="o">~</span> <span class="n">squared_predicted</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>Based on this plot, it looks like there’s no systematic problems with our model. There’s still error in the model (the residuals are non-zero), but these residuals are randomly distributed for each value of the predicted score.</p>
<p>Compare that to the predictions and residuals from the linear, misspecified model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_data</span><span class="o">$</span><span class="n">linear_predicted</span> <span class="o">&lt;-</span> <span class="nf">predict</span><span class="p">(</span><span class="n">linear_model</span><span class="p">)</span>
<span class="n">sim_data</span><span class="o">$</span><span class="n">linear_resid</span> <span class="o">&lt;-</span> <span class="nf">resid</span><span class="p">(</span><span class="n">linear_model</span><span class="p">)</span>
<span class="nf">gf_point</span><span class="p">(</span><span class="n">linear_resid</span> <span class="o">~</span> <span class="n">linear_predicted</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Clearly there’s some structure to this plot. Predicted values at the extremes of the scale are likely to be under-predictions (positive residuals), and values in the middle of the scale are likely to be over-predictions (negative residuals).</p>
<p>If you see structure like this in a predicted-by-residual plot, that tells you there’s probably a nonlinear relationship between the predictor variable and the outcome variable. It is then your job to figure out what kind of nonlinear relationship it might be.</p>
</section>
<section id="non-parametric-models">
<h2>14.5 Non-parametric models<a class="headerlink" href="#non-parametric-models" title="Permalink to this headline">#</a></h2>
<p>It’s rare to know enough about the data generation process to hypothesize a nonlinear relationship between predictors and an outcome. Nonlinear models make a fairly stringent assumption about the exact relationship between variables.</p>
<p>In fact, even linear models make a somewhat stringent assumption. They assume that the best fitting line is straight - that for every one-unit increase in the predictor, and <em>any</em> one-unit increase in the predictor, there is a reliable change in the outcome.</p>
<p>Sometimes we’re not even ready to make a hypothesis that strong. We may not know if the effect of the predictor should be the same for every value of the predictor. Maybe we even suspect that it’s not, but we have no inclination what type of nonlinear pattern would better characterize the relationship.</p>
<p>In that case, we can use <strong>non-parametric models</strong>. These models remove the real-world units from each variable, and represent values instead in terms of their ranks relative to the rest of the variable. The table below shows an example of a variable holding people’s thumb lengths in millimeters, and the corresponding ranks of those values:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Thumb length (mm)</p></th>
<th class="text-align:center head"><p>Thumb length (rank)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>68</p></td>
<td class="text-align:center"><p>6</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>63</p></td>
<td class="text-align:center"><p>4</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>60</p></td>
<td class="text-align:center"><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>61</p></td>
<td class="text-align:center"><p>3</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>64</p></td>
<td class="text-align:center"><p>5</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>56</p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>When we do this, we lose the ability to make predictions about a particular magnitude of change in a predictor variable leading to a particular magnitude of change in the outcome variable. We no longer know how different rank 3 is from rank 4 in terms of the variable’s units. These models are called non-parametric because we’re losing the ability to estimate specific parameters in the population.</p>
<p>However, we gain the ability to model <em>any</em> sort of relationship between the predictor and outcome that might exist, so long as that relationship is <strong>monotonic</strong> (whatever sort of line best fits the data, it is always going only up or only down). The results of these models let us make a more general conclusion than any specific relationship between predictors and an outcome. They let us say, and only say, “as X goes up, Y is predicted to go up (or down)”.</p>
<p>To use a non-parametric model, we first have to convert all relevant variables into their ranks. To do this in R, use the <code class="docutils literal notranslate"><span class="pre">rank()</span></code> function. <code class="docutils literal notranslate"><span class="pre">rank()</span></code> has a few important arguments:</p>
<ul class="simple">
<li><p>the first argument is a vector of data to convert to ranks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">na.last=</span></code> tells the function how to handle NA values. Use <code class="docutils literal notranslate"><span class="pre">na.last=TRUE</span></code> (the default) if you want NAs to receive the last rank, <code class="docutils literal notranslate"><span class="pre">na.last=FALSE</span></code> if they should receive rank 1, <code class="docutils literal notranslate"><span class="pre">na.last=NA</span></code> if you want to remove these datapoints entirely from the vector, or <code class="docutils literal notranslate"><span class="pre">na.last=&quot;keep&quot;</span></code> if you want them to stay in the vector but keep the value NA. This should be the option you use if you want to preserve the same shape of the vector.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ties.method=</span></code> tells the function what to do in the case of data points with the same value. <code class="docutils literal notranslate"><span class="pre">ties.method=&quot;first&quot;</span></code> gives the first tied value found in the vector a lower rank than later found values; <code class="docutils literal notranslate"><span class="pre">ties.method=&quot;last&quot;</span></code> will do the opposite. <code class="docutils literal notranslate"><span class="pre">ties.method=&quot;random&quot;</span></code> puts tied values in random order whereas the default, <code class="docutils literal notranslate"><span class="pre">ties.method=&quot;average&quot;</span></code>, replaces them by their mean. <code class="docutils literal notranslate"><span class="pre">ties.method=&quot;max&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">ties.method=&quot;min&quot;</span></code> replaces them by their maximum and minimum rank, respectively.</p></li>
</ul>
<p>Here is how we can convert <code class="docutils literal notranslate"><span class="pre">predictor</span></code> and <code class="docutils literal notranslate"><span class="pre">outcome</span></code> from above into ranks in order to model their relationship without knowing whether or not that relationship is linear or nonlinear:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_data</span><span class="o">$</span><span class="n">predictor_rank</span> <span class="o">&lt;-</span> <span class="nf">rank</span><span class="p">(</span><span class="n">sim_data</span><span class="o">$</span><span class="n">predictor</span><span class="p">,</span> <span class="n">na.last</span><span class="o">=</span><span class="s">&quot;keep&quot;</span><span class="p">,</span> <span class="n">ties.method</span><span class="o">=</span><span class="s">&quot;average&quot;</span><span class="p">)</span>
<span class="n">sim_data</span><span class="o">$</span><span class="n">outcome_rank</span> <span class="o">&lt;-</span> <span class="nf">rank</span><span class="p">(</span><span class="n">sim_data</span><span class="o">$</span><span class="n">outcome</span><span class="p">,</span> <span class="n">na.last</span><span class="o">=</span><span class="s">&quot;keep&quot;</span><span class="p">,</span> <span class="n">ties.method</span><span class="o">=</span><span class="s">&quot;average&quot;</span><span class="p">)</span>

<span class="nf">gf_point</span><span class="p">(</span><span class="n">outcome_rank</span> <span class="o">~</span> <span class="n">predictor_rank</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">gf_lm</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="predictor-interactions">
<h2>14.6 Predictor interactions<a class="headerlink" href="#predictor-interactions" title="Permalink to this headline">#</a></h2>
<p>Another way the effect of a predictor can vary depending on its value is in the case of interactions <em>between</em> predictors.</p>
<p>Suppose that there is a cholesterol lowering drug that is tested through a clinical trial. Suppose we are expecting a linear dose-response over a given range of drug dose, so that the picture looks like this:</p>
<img src="images/ch14-lineardrug.png" width="450">
<p>This is a standard simple linear model. Now, however, suppose that we expect men to respond at an overall higher level compared to women. There are various ways that this can happen. For example, if the difference in response between women and men is constant throughout the range of drug doses (i.e., an effect of sex regardless of the effect of dose), we would expect a graph like this:</p>
<img src="images/ch14-maineffectdrug.png" width="450">
<p>This is the situation we have worked with before. Another name for this is that there is a <strong>main effect</strong> of sex and a <strong>main effect</strong> of drug dose. A main effect means the effect is present no matter the value of the other variable.</p>
<p>However, maybe men actually have a steeper dose-response curve compared to women, like this:</p>
<img src="images/ch14-interactiondrug1.png" width="450">
<p>On the other hand, if men have a less steep dose-response curve compared to women, we would expect a picture like this:</p>
<img src="images/ch14-interactiondrug2.png" width="450">
<p>Of these four graphs, the first indicates no difference between men and women. The second illustrates that there is a difference, but since it is constant, there are only main effects of drug dose and mex. The third and fourth graphs represent situations with an <strong>interaction</strong>. An interaction is when the effect of a variable for predicting values of the outcome variable <em>depends on</em> values of another variable. In this case, the change in predicted cholesterol for every one-unit increase of the drug dose depends on whether it is given to men or women.</p>
<p>In terms of regression equations, we have:</p>
<p><strong>No effect of sex:</strong></p>
<div class="math notranslate nohighlight">
\[Y_i = b_0 + b_1dose_i + e_i\]</div>
<p>where Y represents the outcome (amount of cholesterol lowering), b<sub>0</sub> is the expected cholesterol lowering when dose = 0, and b<sub>1</sub> is the difference in expected cholesterol lowering for every one-unit increase in drug dose.</p>
<p><strong>Sex has an effect, but no interaction:</strong></p>
<div class="math notranslate nohighlight">
\[Y_i = b_0 + b_1dose_i + b_2sex_i + e_i\]</div>
<p>where Y represents the outcome (amount of cholesterol lowering), b<sub>0</sub> is the expected cholesterol lowering when dose = 0 and sex = 0 (in the reference group), b<sub>1</sub> is the difference in expected cholesterol lowering for every one-unit increase in drug dose regardless of sex, and b<sub>2</sub> is the change in expected cholesterol lowering between men and women regardless of dose. By adding the dose and sex components independently in this equation, we are hypothesizing that the effect of dose (slope) is the same regardless of sex, and vice versa.</p>
<p>To write an equation for the situation with an interaction, we need to add a component to the equation that will change value depending on <em>both</em> the value of dose and sex, for each data point.</p>
<p><strong>Sex has an effect, with an interaction:</strong></p>
<div class="math notranslate nohighlight">
\[Y_i = b_0 + b_1dose_i + b_2sex_i + b_3dose_i*sex_i + e_i\]</div>
<p>In an interaction, it’s not possible to interpret the effect of one variable without the context of the other. It’s any situation where you might say “it depends” for making predictions. Is sun exposure related to skin cancer risk? It depends on if you’re wearing sunscreen or not. Does adding more mustard make food more tasty? It depends on if that food is a hot dog or ice cream (or maybe not - you do you.)</p>
<p>Because of this dependence between the variables now, interpreting the coefficients gets tricky. If the equation looked specifically like:</p>
<div class="math notranslate nohighlight">
\[Y_i = 0 + 0.5dose_i + 15sex_i - 0.25dose_i*sex_i + e_i\]</div>
<p>you should interpret b<sub>0</sub>, b<sub>1</sub>, and b<sub>2</sub> in the contexts of when the other variable is 0. Here:</p>
<ul class="simple">
<li><p>b<sub>0</sub> (the intercept) is the expected cholesterol lowering when dose = 0 and sex = 0.</p></li>
<li><p>b<sub>1</sub> (the main effect of dose) is the expected change in cholesterol lowering for every one-unit increase in dose, <em>when sex = 0</em> (i.e., for the reference group).</p></li>
<li><p>b<sub>2 </sub> (the main effect of sex) is the expected change in cholesterol lowering between males and females, <em>when dose = 0</em>.</p></li>
</ul>
<p>Now, let’s get to b<sub>3</sub> (the interaction coefficient). Think of this as the change in a <em>main effect</em>, for every one-unit increase of another variable. For our case, we could say for every one-unit increase in dose, the difference in predicted cholesterol between males and females is decreasing by 0.25 (b<sub>3</sub> = -0.25). Or interpreted the other way, by going from females to males (females being the reference group here), we expect the difference in cholestrol between a dose of 0 and a dose of 1 to be 0.25 less.</p>
<p>In the pictures above, a negative interaction term means the distance between lines for levels 0 and 1 is shrinking (or flipping negative) as you move up the x-axis. A positive interaction term means the distance between lines for levels 0 and 1 is growing (or flipping positive) as you move up the x-axis. The magnitude of the interaction term describes the speed at which that is happening.</p>
<p>Coefficient interpretation gets really complicated for interaction models. And takes a lot of words to write out. But it’s important to practice fully writing out what you expect to happen to your predictions under different values of the explanatory variables in concrete terms, not just saying things like “negative interaction effect between dose and sex.” That statement is removed from the units and real-world meaning of the variables. When interpreting coefficients, we want to stay as close to the real units as we can so that we keep sight of how important these prediction changes are in a practical sense.</p>
<p>Now consider the above example, but with age and dose as independent variables. Notice that this means we have two continuous variables, rather than one continuous and one categorical variable. In the absence of an interaction term, we simply have the model:</p>
<div class="math notranslate nohighlight">
\[Y_i = b_0 + b_1dose_i + b_2age_i + e_i\]</div>
<p>With no interaction, interpretation of each effect is straightforward, as we just have a standard multiple linear regression model.</p>
<p>Even though age will be treated as a continuous variable here, suppose for an instant it was coded as dichotomous, simply representing “old” and “young” subjects. Now we would be back to the case already discussed above in detail, and the graph would look something like this:</p>
<img src="images/ch14-interactionage2.png" width="450">
<p>In this hypothetical case, we see that the effects of dose on cholesterol lowering starts higher in younger compared to older subjects, but becomes lower as dose is increased. What if we now add a middle category of “middle aged” persons? The graph may now look something like this:</p>
<img src="images/ch14-interactionage3.png" width="450">
<p>And if even more categories of age were added, we might get something like this:</p>
<img src="images/ch14-interactionagemany.png" width="450">
<p>Now imagine adding finer and finer age categories, slowly transforming the age variable from discrete (categorical) into a continuous variable. At the point where age becomes continuous, we would have an infinite number of different slopes for the effect of dose, one slope for each of the infinite possible age values. This is what we have when we have a model with two continuous variables that interact with each other.</p>
<p>The model we would then have would look like this:</p>
<div class="math notranslate nohighlight">
\[Y_i = b_0 + b_1dose_i + b_2age_i + b_3dose_i*age_i + e_i\]</div>
<p>or using example numbers for the coefficients:</p>
<div class="math notranslate nohighlight">
\[Y_i = 0 + 0.5dose_i + 0.02age_i + 0.01dose_i*age_i + e_i\]</div>
<p>This means that the effect of dose changes depending on the age of the subject, so that there is really no “unique” effect of dose. It is different for each possible age value. For someone aged 30, the simple model is:</p>
<div class="math notranslate nohighlight">
\[\hat{Y} = 0 + 0.5dose_i + 0.02*30 + 0.01dose_i*30 = 0.6 + 0.5dose_i + 0.3dose_i = 0.6 + 0.8dose_i\]</div>
<p>For someone aged 60, the simple model is:</p>
<div class="math notranslate nohighlight">
\[\hat{Y} = 0 + 0.5dose_i + 0.02*60 - 0.01dose_i*60 = 1.2 + 0.5dose_i + 0.6dose_i = 1.2 + 1.1dose_i\]</div>
<p>This means that the cholesterol drug has a stronger effect on people aged 60 than people aged 30.</p>
<p>The effect of age is similarly affected by dose. If the dose is, say, dose = 0, then the simple model of age on cholesterol lowering is:</p>
<div class="math notranslate nohighlight">
\[\hat{Y} = 0 + 0.5*0 + 0.02age_i + 0.01*0*age_i = 0.02age_i\]</div>
<p>If the dose is 20, the simple model is:</p>
<div class="math notranslate nohighlight">
\[\hat{Y} = 0 + 0.5*20 + 0.02age_i + 0.01_20*age_i = 10 + 0.02age_i + 0.2age_i = 10 + 0.22age_i\]</div>
<p>I.e., age has a bigger effect on cholesterol lowering with larger doses.</p>
<p>To fit an interaction model in R, either make a new transformed variable that multiplies the column of predictor 1 by the column of predictor 2, or do the multiplication directly in the formula of the model call:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#simulation for the situation above</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
<span class="n">dose</span> <span class="o">&lt;-</span> <span class="nf">abs</span><span class="p">(</span><span class="nf">runif</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">100</span><span class="p">))</span> <span class="c1">#uniformly distributed doses</span>
<span class="n">age</span> <span class="o">&lt;-</span> <span class="nf">abs</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">45</span><span class="p">,</span> <span class="m">20</span><span class="p">))</span> <span class="c1">#normally distributed ages</span>
<span class="n">error</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
<span class="n">cholesterol</span> <span class="o">&lt;-</span> <span class="m">0.5</span><span class="o">*</span><span class="n">dose</span> <span class="o">+</span> <span class="m">0.02</span><span class="o">*</span><span class="n">age</span> <span class="o">+</span> <span class="m">0.01</span><span class="o">*</span><span class="n">dose</span><span class="o">*</span><span class="n">age</span> <span class="o">+</span> <span class="n">error</span>
<span class="n">cholesterol_data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">cholesterol</span><span class="p">,</span> <span class="n">dose</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span>

<span class="c1">#fitting interaction model</span>
<span class="n">cholesterol_model</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">cholesterol</span> <span class="o">~</span> <span class="n">dose</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span> <span class="n">dose</span><span class="o">*</span><span class="n">age</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cholesterol_data</span><span class="p">)</span>
<span class="n">cholesterol_model</span>
</pre></div>
</div>
</div>
</div>
<p>The intercept is still the first coefficient, the main effects are the next two, and the interaction coefficient is the one labeled “dose:age”.</p>
<p>For visualizing interactions, there is a handy package called <code class="docutils literal notranslate"><span class="pre">interactions</span></code> with a function <code class="docutils literal notranslate"><span class="pre">interact_plot()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;interactions&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">interactions</span><span class="p">)</span>

<span class="c1">#plotting interaction</span>
<span class="nf">interact_plot</span><span class="p">(</span><span class="n">cholesterol_model</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">dose</span><span class="p">,</span> <span class="n">modx</span> <span class="o">=</span> <span class="n">age</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This function takes a model object, a <code class="docutils literal notranslate"><span class="pre">pred</span> <span class="pre">=</span></code> argument to denote which variable you want to see on the x-axis, and a <code class="docutils literal notranslate"><span class="pre">modx</span> <span class="pre">=</span> </code> argument to denote which variable should receive different regression lines in the plot. When <code class="docutils literal notranslate"><span class="pre">modx</span></code> is a categorical variable, a separate line will be plotted for every level of the variable. If <code class="docutils literal notranslate"><span class="pre">modx</span></code> is a continuous variable, some select lines will be plotted that represent the value of +1SD on that variable, the mean, and -1SD. This allows you to look at the spread of the lines and see how an interaction effect amplifies or attenuates a main effect in the context of another variable.</p>
<p>You can also make this plot to include the data points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#plotting interaction with datapoints </span>
<span class="nf">interact_plot</span><span class="p">(</span><span class="n">cholesterol_model</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">dose</span><span class="p">,</span> <span class="n">modx</span> <span class="o">=</span> <span class="n">age</span><span class="p">,</span> <span class="n">plot.points</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>But this sometimes makes the graph more confusing to understand, than easier. Remember that a purpose of a graphical plot is to clearly communicate a conclusion you want the viewer to have. With simple models, adding the data points helps with that. But with complex models like interactions, it can be counterproductive. Always consider how well your message is coming across when you make visualization choices.</p>
<p><code class="docutils literal notranslate"><span class="pre">interact_plot()</span></code> has a lot more features to help you control how it looks. To see more of those, visit <a class="reference external" href="https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html">this page</a>.</p>
</section>
<section id="choosing-the-best-model">
<h2>14.7 Choosing the best model<a class="headerlink" href="#choosing-the-best-model" title="Permalink to this headline">#</a></h2>
<p>In just a few chapters, we’ve learned about so many model forms - simple group model, simple regression, multivariable models, nonlinear transformations, nonparametric, and now interaction models. It may start to feel overwhelming to know what model structure you should choose for any particular research question.</p>
<p>Indeed, it is not an easy task. We are trying to understand the data generation process as best we can, in terms of what explanatory variables are included and how they relate to an outcome, but human psychology is very complex and we’re almost never sure about what the best model truly is. Researchers argue over these details every day. It’s important that you understand the breadth of available models, and some are more obviously wrong than others, but choosing the absolute best one is a difficult feat.</p>
<p>It is important to get comfortable with not always being right, and with having opinions that are different than other people. To pick a model structure to work with, start with what you think makes the most sense given what you already know about the topic you are trying to study. Then collect some data, evaluate how right or wrong you are, and update your theories accordingly. This is how science advances.</p>
<p>It is important that you stake an opinion on the likely best model for each research question, or perhaps a couple candidates that you want to directly compare. What you should <em>not</em> do is test out every possible model you can think of to see which is the best. As we will talk about more in later chapters, practices like testing many models with the same data and picking the best one based on what <em>that sample of data</em> tells you is a form of overfitting, and leads to conclusions that don’t replicate in other data samples. This practice is part of what lead to the <a class="reference external" href="https://en.wikipedia.org/wiki/Replication_crisis">Replication Crisis</a> in psychology.</p>
<p>To help keep you honest and avoid the inclination to seek out the best model for one dataset, there are some techniques you can practice. If you have an idea about what the likely best model is, you can <strong>pre-register</strong> that idea. A preregistration is when you write down, ideally somewhere public like the repository of the <a class="reference external" href="https://osf.io/">Open Science Framework</a>, what you plan to do in your research and what model specification you are going to test. That way, you can’t hide from when your model is maybe not as good as you were hoping. You have to face whether or not this performance refutes your hypotheses, rather than making up a new hypothesis in light of the data and claiming you were right all along (this is a bad practice called HARKing - Hypothesizing After Results are Known).</p>
<p>If you don’t have a strong hypothesis yet and you’re not ready to pre-register, you can do what’s called <strong>exploratory analysis</strong>. This is when you do test out many models to see which has the best fit. But, you can’t stop there. At this point, you wouldn’t know if your best model is a good reflection of the data generation process, or just overfit for this dataset in particular. Then next step is to them do <strong>confirmatory analysis</strong> with a new, fresh set of data. That way, you can investigate if your model is robust and still has good performance no matter the data.</p>
<p>If your dataset is large enough, you can do both exploratory and confirmatory analysis without running a whole new study. You can split your data in half, find the best fitting model in one half, then <strong>replicate</strong> that model in the other half. If your replication is pretty similar to the original performance in the first half, you’ve successfully avoided overfitting.</p>
<p>What makes a dataset big enough to run an internal replication, rather than needing to collect a whole new dataset? We’ll talk more about that in chapter 18.</p>
</section>
<section id="chapter-summary">
<h2>Chapter summary<a class="headerlink" href="#chapter-summary" title="Permalink to this headline">#</a></h2>
<p>After reading this chapter, you should be able to:</p>
<ul class="simple">
<li><p>Understand the difference between a linear and nonlinear model</p></li>
<li><p>Fit a nonlinear model with transformed variables</p></li>
<li><p>Interpret coefficients in a nonlinear model</p></li>
<li><p>Identify when a nonlinear model might be better, based on a predictor-by-residual plot</p></li>
<li><p>Explain a non-parametric model</p></li>
<li><p>Transform variables into their ranks</p></li>
<li><p>Explain an interaction model</p></li>
<li><p>Fit an interaction model</p></li>
<li><p>Interpret the coefficients in an interaction model</p></li>
<li><p>Plot an interaction model</p></li>
<li><p>Decide how you will pick a particular model structure for your research question</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "smburns47/Psyc158",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Shannon Burns<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>